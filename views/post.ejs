<%- include('partials/header') -%>
<body>
  <div class="bg-gray-100 w-full h-auto flex flex-col justify-center items-center p-14">
  <div class="max-w-5xl max-h-full mx-auto bg-white border border-gray-200 rounded-lg shadow-md p-5">
    <!-- Header -->
    <div class="flex items-center mb-4 flex-wrap">
      <a href="/profile/<%= postUser._id %>" class="w-10 h-10">
        <img
          src="<%= postUser.profileImage || '/imgs/anyn.png' %>"
          alt="Profile Picture"
          class="w-10 h-10 rounded-full"
        />
      </a>
      <div class="ml-3 mt-2 sm:mt-0">
        <h1 class="text-base font-semibold text-gray-900"><%= postUser.userName %></h1>
      </div>
    </div>
  
    <!-- Separator Line -->
    <div class="-mx-4 border-t border-gray-200"></div>
  
    <!-- Post Content -->
    <h1 class="text-lg font-bold text-gray-900 my-3"><%= post.title %></h1>
    <div class="rounded-lg overflow-hidden mb-4">
      <img
        src="<%= post.image %>"
        alt="Post Image"
        class="w-full max-w-full h-auto"
      />
    </div>
    <h2 class="text-sm sm:text-base text-gray-800 mb-4"><%= post.caption %></h2>
  
    <!-- Engagement -->
    <div class="flex items-center justify-between text-gray-600 text-sm flex-wrap">
      <div class="flex space-x-4">
        <form action="/post/likePost/<%= post.id %>?_method=PUT" method="POST">
          <button
            class="flex items-center space-x-1 text-gray-600 hover:text-blue-500"
            type="submit"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-5 w-5"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="<%= post.likedBy && post.likedBy.includes(user.id) ? 'M14 9l-5 5m0 0l5 5m-5-5H2' : 'M5 13l4 4L19 7' %>"
              />
            </svg>
            <span><%= post.likedBy && post.likedBy.includes(user.id) ? 'Unlike' : 'Like' %></span>
          </button>
        </form>
        <span class="text-purple-500"><%= post.likes %> Likes</span>
      </div>
      <% if (post.user._id.toString() === loggedInUser.id.toString()) { %>
        <form action="/post/deletePost/<%= post.id %>?_method=DELETE" method="POST">
          <button class="text-red-500 hover:text-red-700 mt-2 sm:mt-0" type="submit">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-5 w-5"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              />
            </svg>
          </button>
        </form>
      <% } %>
    </div>
  
    <!-- Separator Line -->
    <div class="-mx-4 border-t border-gray-200 my-4"></div>
  
 <!-- Comments Section -->
<div class="mt-6">
  <h2 class="text-lg font-bold text-gray-900 mb-4">Comments <span class="text-orange-600"><%= post.comments %></span></h2>
  <ul class="space-y-4">
    <% comments.forEach(comment => { %>
      <li class="flex items-start space-x-3">
        <img
          src="<%= comment.user && comment.user.profileImage || '/imgs/anyn.png' %>"
          alt="Commenter Profile Picture"
          class="w-8 h-8 rounded-full"
        />
        <div>
          <p class="text-sm font-semibold text-gray-900">
            <%= comment.user && comment.user.userName || 'Anonymous' %>
          </p>
          <p class="text-sm text-gray-700"><%= comment.comment %></p>

          <!-- Delete Icon -->
          <% if (loggedInUser && comment.user._id.toString() === loggedInUser._id.toString()) { %>
            <form action="/comment/deleteComment/<%= comment._id %>" method="POST" class="inline">
              <button type="submit" class="text-red-500 hover:text-red-700">
                <i class="fas fa-trash-alt"></i> Delete
              </button>
            </form>
          <% } %>
        </div>
      </li>
    <% }) %>
  </ul>
</div>

    <!-- Separator Line -->
    <div class="-mx-4 border-t border-gray-200 my-4"></div>
  
    <!-- Comment Input -->
    <div class="flex flex-wrap items-center mt-6 space-x-2">
      <img
        src="<%= loggedInUser.profileImage || '/imgs/anyn.png' %>"
        alt="User Profile Picture"
        class="w-10 h-10 rounded-full"
      />
      <form action="/comment/createComment/<%= post._id %>" method="POST" class="flex-1">
        <input
          type="text"
          name="comment"
          placeholder="Write your comment..."
          class="w-full px-4 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          required
        />
        <button
          type="submit"
          class="bg-blue-500 text-white px-4 py-2 text-sm font-medium rounded-lg hover:bg-blue-600 mt-2"
        >
          Submit
        </button>
      </form>
    </div>
  </div>
  </div>
  </body>
  

<%- include('partials/footer') -%>
